<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Windows 95 Mobile Emulation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        @font-face {
            font-family: 'MS Sans Serif';
            src: url('https://unpkg.com/win95-font@1.0.0/ms_sans_serif.woff2') format('woff2');
        }
        
        @font-face {
            font-family: 'MS Sans Serif Bold';
            src: url('https://unpkg.com/win95-font@1.0.0/ms_sans_serif_bold.woff2') format('woff2');
        }
        
        * {
            cursor: none !important;
            user-select: none;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            touch-action: none;
        }
        
        body {
            font-family: 'MS Sans Serif', 'VT323', monospace;
            overflow: hidden;
            background: #008080;
            margin: 0;
            padding: 0;
            height: 100vh;
            width: 100vw;
        }
        
        .win95-bevel {
            border-style: solid;
            border-width: 2px;
            border-top-color: #dfdfdf;
            border-left-color: #dfdfdf;
            border-right-color: #808080;
            border-bottom-color: #808080;
            background-color: #c0c0c0;
        }
        
        .win95-bevel-inset {
            border-style: solid;
            border-width: 2px;
            border-top-color: #808080;
            border-left-color: #808080;
            border-right-color: #dfdfdf;
            border-bottom-color: #dfdfdf;
            background-color: #c0c0c0;
        }
        
        .win95-button {
            border-style: solid;
            border-width: 2px;
            border-top-color: #dfdfdf;
            border-left-color: #dfdfdf;
            border-right-color: #808080;
            border-bottom-color: #808080;
            background-color: #c0c0c0;
            font-family: 'MS Sans Serif', monospace;
            font-size: 12px;
            padding: 3px 12px;
            min-width: 75px;
        }
        
        .win95-button:active {
            border-top-color: #808080;
            border-left-color: #808080;
            border-right-color: #dfdfdf;
            border-bottom-color: #dfdfdf;
        }
        
        .win95-titlebar {
            background: linear-gradient(90deg, #000080, #1084d0);
            color: white;
            font-family: 'MS Sans Serif Bold', monospace;
            font-size: 12px;
            padding: 3px 5px;
            letter-spacing: 0.5px;
        }
        
        .win95-scrollbar {
            background: #c0c0c0;
            border: 2px inset #c0c0c0;
        }
        
        .win95-scrollbar-thumb {
            background: #c0c0c0;
            border: 2px outset #c0c0c0;
        }
        
        .win95-menu {
            border: 2px solid #c0c0c0;
            box-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .win95-menu-item:hover {
            background-color: #000080;
            color: white;
        }
        
        .cursor-default {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"><path d="M0,0 L0,16 L4,12 L6,14 L6,10 L16,16 L10,6 L14,4 L12,0 Z" fill="black"/><path d="M1,1 L1,14 L4,11 L7,14 L7,9 L14,14 L9,7 L11,4 L14,1 Z" fill="white"/></svg>') 0 0, auto;
        }
        
        .cursor-pointer {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"><path d="M0,0 L0,16 L2,14 L4,16 L4,4 L16,16 L10,6 L14,4 L12,0 Z" fill="black"/><path d="M1,1 L1,14 L3,12 L5,14 L5,5 L14,14 L9,7 L11,5 L14,1 Z" fill="white"/></svg>') 0 0, auto;
        }
        
        /* Minesweeper specific */
        .cell-hidden {
            background: #c0c0c0;
            border: 2px outset #c0c0c0;
        }
        
        .cell-revealed {
            background: #c0c0c0;
            border: 1px solid #808080;
            font-family: 'MS Sans Serif Bold';
            font-size: 14px;
        }
        
        .cell-flag {
            background: #c0c0c0;
            border: 2px outset #c0c0c0;
            color: red;
            font-size: 12px;
            text-align: center;
        }
        
        .number-1 { color: #0000ff; }
        .number-2 { color: #008000; }
        .number-3 { color: #ff0000; }
        .number-4 { color: #000080; }
        .number-5 { color: #800000; }
        .number-6 { color: #008080; }
        .number-7 { color: #000000; }
        .number-8 { color: #808080; }
    </style>
</head>
<body class="relative w-full h-full overflow-hidden bg-teal-900">
    <!-- Windows 95 Desktop Background -->
    <div id="desktop" class="absolute inset-0 bg-teal-900 bg-opacity-90">
        <!-- Desktop Icons -->
        <div id="icon-mycomputer" class="absolute left-8 top-8 w-16 text-center cursor-pointer select-none" ondblclick="openApp('mycomputer')">
            <div class="win95-bevel p-1 mb-1">
                <img src="https://img.icons8.com/color/48/000000/computer.png" alt="My Computer" class="w-8 h-8 mx-auto">
            </div>
            <span class="text-white text-xs font-bold bg-teal-900 px-1">My Computer</span>
        </div>
        
        <div id="icon-recyclebin" class="absolute left-8 top-32 w-16 text-center cursor-pointer select-none" ondblclick="openApp('recyclebin')">
            <div class="win95-bevel p-1 mb-1">
                <img src="https://img.icons8.com/color/48/000000/trash.png" alt="Recycle Bin" class="w-8 h-8 mx-auto">
            </div>
            <span class="text-white text-xs font-bold bg-teal-900 px-1">Recycle Bin</span>
        </div>
        
        <div id="icon-notepad" class="absolute left-8 top-56 w-16 text-center cursor-pointer select-none" ondblclick="openApp('notepad')">
            <div class="win95-bevel p-1 mb-1">
                <img src="https://img.icons8.com/color/48/000000/document.png" alt="Notepad" class="w-8 h-8 mx-auto">
            </div>
            <span class="text-white text-xs font-bold bg-teal-900 px-1">Notepad</span>
        </div>
        
        <div id="icon-minesweeper" class="absolute left-8 top-80 w-16 text-center cursor-pointer select-none" ondblclick="openApp('minesweeper')">
            <div class="win95-bevel p-1 mb-1">
                <img src="https://img.icons8.com/color/48/000000/mine.png" alt="Minesweeper" class="w-8 h-8 mx-auto">
            </div>
            <span class="text-white text-xs font-bold bg-teal-900 px-1">Minesweeper</span>
        </div>
    </div>
    
    <!-- Windows will be dynamically added here -->
    <div id="window-container" class="absolute inset-0 pointer-events-none">
        <!-- Windows will be created here by JavaScript -->
    </div>
    
    <!-- Taskbar -->
    <div id="taskbar" class="absolute bottom-0 left-0 right-0 h-12 win95-bevel flex items-center px-1 z-50 pointer-events-auto">
        <!-- Start Button -->
        <button id="start-button" class="win95-bevel px-3 h-10 flex items-center font-bold text-sm mr-2 active:win95-bevel-inset" onclick="toggleStartMenu()">
            <img src="https://img.icons8.com/color/16/000000/windows-logo.png" alt="Start" class="mr-2">
            Start
        </button>
        
        <!-- Start Menu (hidden by default) -->
        <div id="start-menu" class="absolute bottom-12 left-1 w-64 bg-c0c0c0 win95-menu hidden z-50">
            <div class="win95-titlebar px-4 py-2 flex items-center">
                <img src="https://img.icons8.com/color/24/000000/windows-logo.png" alt="Windows" class="mr-2">
                <span class="font-bold">Windows 95</span>
            </div>
            <div class="p-2">
                <div class="win95-menu-item px-4 py-2 mb-1 hover:bg-blue-800 hover:text-white" onclick="openApp('notepad')">
                    <img src="https://img.icons8.com/color/16/000000/document.png" alt="Notepad" class="inline mr-2">
                    Notepad
                </div>
                <div class="win95-menu-item px-4 py-2 mb-1 hover:bg-blue-800 hover:text-white" onclick="openApp('minesweeper')">
                    <img src="https://img.icons8.com/color/16/000000/mine.png" alt="Minesweeper" class="inline mr-2">
                    Minesweeper
                </div>
                <div class="win95-menu-item px-4 py-2 mb-1 hover:bg-blue-800 hover:text-white" onclick="openApp('calculator')">
                    <img src="https://img.icons8.com/color/16/000000/calculator.png" alt="Calculator" class="inline mr-2">
                    Calculator
                </div>
                <div class="win95-menu-item px-4 py-2 mb-1 hover:bg-blue-800 hover:text-white" onclick="openApp('paint')">
                    <img src="https://img.icons8.com/color/16/000000/paint-brush.png" alt="Paint" class="inline mr-2">
                    Paint
                </div>
                <hr class="my-2 border-gray-400">
                <div class="win95-menu-item px-4 py-2 hover:bg-blue-800 hover:text-white" onclick="shutdown()">
                    <img src="https://img.icons8.com/color/16/000000/shutdown.png" alt="Shutdown" class="inline mr-2">
                    Shut Down...
                </div>
            </div>
        </div>
        
        <!-- Taskbar Programs -->
        <div id="taskbar-programs" class="flex-1 flex items-center h-full overflow-x-auto">
            <!-- Programs will be added here dynamically -->
        </div>
        
        <!-- Clock -->
        <div id="clock" class="win95-bevel-inset px-3 py-1 text-sm font-bold min-w-20 text-center">
            12:00 PM
        </div>
    </div>
    
    <!-- Custom Windows 95 Cursor -->
    <div id="custom-cursor" class="absolute w-6 h-6 pointer-events-none z-9999 hidden">
        <svg width="32" height="32" viewBox="0 0 32 32">
            <path d="M0,0 L0,32 L8,24 L12,28 L12,20 L32,32 L20,12 L24,8 L16,0 Z" fill="black"/>
            <path d="M2,2 L2,28 L8,22 L10,24 L10,18 L28,28 L18,10 L22,8 L28,2 Z" fill="white"/>
        </svg>
    </div>

    <script>
        // Global Variables
        let windows = [];
        let activeWindow = null;
        let cursorPos = { x: window.innerWidth / 2, y: window.innerHeight / 2 };
        let touchStartTime = 0;
        let touchStartPos = { x: 0, y: 0 };
        let isDraggingWindow = false;
        let dragWindow = null;
        let dragOffset = { x: 0, y: 0 };
        let isLongPress = false;
        let longPressTimer = null;
        
        // Minesweeper variables
        let minesweeperGame = null;
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            initCursor();
            initClock();
            setupTouchEvents();
            createWelcomeWindow();
        });
        
        // Custom Cursor Implementation
        function initCursor() {
            const cursor = document.getElementById('custom-cursor');
            cursor.style.left = cursorPos.x + 'px';
            cursor.style.top = cursorPos.y + 'px';
            cursor.style.display = 'block';
            
            document.addEventListener('touchstart', handleTouchStart, { passive: false });
            document.addEventListener('touchmove', handleTouchMove, { passive: false });
            document.addEventListener('touchend', handleTouchEnd, { passive: false });
        }
        
        function handleTouchStart(e) {
            e.preventDefault();
            touchStartTime = Date.now();
            const touch = e.touches[0];
            touchStartPos = { x: touch.clientX, y: touch.clientY };
            
            // Check if touch is on a window title bar
            const element = document.elementFromPoint(touch.clientX, touch.clientY);
            if (element && (element.classList.contains('win95-titlebar') || element.closest('.win95-titlebar'))) {
                const windowElement = element.closest('.window');
                if (windowElement) {
                    dragWindow = windowElement;
                    const rect = windowElement.getBoundingClientRect();
                    dragOffset = {
                        x: touch.clientX - rect.left,
                        y: touch.clientY - rect.top
                    };
                    
                    // Set long press timer for window drag
                    longPressTimer = setTimeout(() => {
                        isLongPress = true;
                        bringToFront(dragWindow.id);
                    }, 500);
                }
            }
        }
        
        function handleTouchMove(e) {
            e.preventDefault();
            const touch = e.touches[0];
            
            // Update cursor position
            cursorPos = { x: touch.clientX, y: touch.clientY };
            const cursor = document.getElementById('custom-cursor');
            cursor.style.left = (cursorPos.x - 4) + 'px';
            cursor.style.top = (cursorPos.y - 4) + 'px';
            
            // Check if we should cancel long press
            const moveThreshold = 10;
            const dx = Math.abs(touch.clientX - touchStartPos.x);
            const dy = Math.abs(touch.clientY - touchStartPos.y);
            
            if (dx > moveThreshold || dy > moveThreshold) {
                clearTimeout(longPressTimer);
                isLongPress = false;
            }
            
            // Handle window dragging
            if (dragWindow && isLongPress) {
                isDraggingWindow = true;
                dragWindow.style.left = (touch.clientX - dragOffset.x) + 'px';
                dragWindow.style.top = (touch.clientY - dragOffset.y) + 'px';
            }
        }
        
        function handleTouchEnd(e) {
            e.preventDefault();
            clearTimeout(longPressTimer);
            
            const touchDuration = Date.now() - touchStartTime;
            const moveThreshold = 10;
            const dx = Math.abs(cursorPos.x - touchStartPos.x);
            const dy = Math.abs(cursorPos.y - touchStartPos.y);
            
            // Handle tap (left click)
            if (touchDuration < 300 && dx < moveThreshold && dy < moveThreshold && !isDraggingWindow) {
                handleClick(cursorPos.x, cursorPos.y);
            }
            
            // Reset drag state
            if (isDraggingWindow) {
                isDraggingWindow = false;
            }
            
            dragWindow = null;
            isLongPress = false;
        }
        
        function handleClick(x, y) {
            const element = document.elementFromPoint(x, y);
            if (element) {
                // Handle button clicks
                if (element.classList.contains('window-close')) {
                    const windowElement = element.closest('.window');
                    if (windowElement) {
                        closeWindow(windowElement.id);
                    }
                } else if (element.classList.contains('window-minimize')) {
                    const windowElement = element.closest('.window');
                    if (windowElement) {
                        minimizeWindow(windowElement.id);
                    }
                } else if (element.classList.contains('window-maximize')) {
                    const windowElement = element.closest('.window');
                    if (windowElement) {
                        maximizeWindow(windowElement.id);
                    }
                } else if (element.classList.contains('win95-titlebar')) {
                    const windowElement = element.closest('.window');
                    if (windowElement) {
                        bringToFront(windowElement.id);
                    }
                }
                
                // Trigger click event
                element.click();
            }
        }
        
        // Window Management
        class Window {
            constructor(id, title, content, width = 400, height = 300) {
                this.id = id;
                this.title = title;
                this.content = content;
                this.width = width;
                this.height = height;
                this.x = 50 + (windows.length * 30);
                this.y = 50 + (windows.length * 30);
                this.isMinimized = false;
                this.isMaximized = false;
                this.originalSize = { width, height, x: this.x, y: this.y };
                
                this.create();
            }
            
            create() {
                const windowContainer = document.getElementById('window-container');
                
                const windowHTML = `
                    <div id="${this.id}" class="window absolute win95-bevel pointer-events-auto z-40" 
                         style="width: ${this.width}px; height: ${this.height}px; left: ${this.x}px; top: ${this.y}px;">
                        <div class="win95-titlebar flex justify-between items-center">
                            <div class="flex items-center">
                                <img src="https://img.icons8.com/color/16/000000/${this.getIcon()}.png" alt="${this.title}" class="mr-2">
                                <span>${this.title}</span>
                            </div>
                            <div class="flex space-x-1">
                                <button class="window-minimize w-6 h-5 win95-bevel text-xs font-bold active:win95-bevel-inset">_</button>
                                <button class="window-maximize w-6 h-5 win95-bevel text-xs font-bold active:win95-bevel-inset">‚ñ°</button>
                                <button class="window-close w-6 h-5 win95-bevel text-xs font-bold active:win95-bevel-inset">X</button>
                            </div>
                        </div>
                        <div class="p-2 h-full overflow-auto win95-scrollbar" style="height: calc(100% - 28px);">
                            ${this.content}
                        </div>
                    </div>
                `;
                
                windowContainer.insertAdjacentHTML('beforeend', windowHTML);
                this.element = document.getElementById(this.id);
                
                // Add to taskbar
                this.addToTaskbar();
                windows.push(this);
                bringToFront(this.id);
            }
            
            getIcon() {
                const icons = {
                    'notepad': 'document',
                    'minesweeper': 'mine',
                    'calculator': 'calculator',
                    'paint': 'paint-brush',
                    'mycomputer': 'computer',
                    'recyclebin': 'trash',
                    'welcome': 'windows-logo'
                };
                return icons[this.id] || 'window';
            }
            
            addToTaskbar() {
                const taskbar = document.getElementById('taskbar-programs');
                const taskbarItem = document.createElement('div');
                taskbarItem.className = 'win95-bevel px-3 py-1 mx-1 text-sm cursor-pointer active:win95-bevel-inset';
                taskbarItem.textContent = this.title;
                taskbarItem.onclick = () => {
                    if (this.isMinimized) {
                        this.restore();
                    } else {
                        bringToFront(this.id);
                    }
                };
                taskbar.appendChild(taskbarItem);
                this.taskbarItem = taskbarItem;
            }
            
            minimize() {
                this.isMinimized = true;
                this.element.style.display = 'none';
                this.taskbarItem.classList.add('win95-bevel-inset');
            }
            
            restore() {
                this.isMinimized = false;
                this.element.style.display = 'block';
                this.taskbarItem.classList.remove('win95-bevel-inset');
                bringToFront(this.id);
            }
            
            maximize() {
                if (this.isMaximized) {
                    // Restore original size
                    this.element.style.width = this.originalSize.width + 'px';
                    this.element.style.height = this.originalSize.height + 'px';
                    this.element.style.left = this.originalSize.x + 'px';
                    this.element.style.top = this.originalSize.y + 'px';
                    this.isMaximized = false;
                } else {
                    // Save original size and maximize
                    this.originalSize = {
                        width: this.element.offsetWidth,
                        height: this.element.offsetHeight,
                        x: parseInt(this.element.style.left),
                        y: parseInt(this.element.style.top)
                    };
                    
                    this.element.style.width = (window.innerWidth - 20) + 'px';
                    this.element.style.height = (window.innerHeight - 120) + 'px';
                    this.element.style.left = '10px';
                    this.element.style.top = '10px';
                    this.isMaximized = true;
                }
                bringToFront(this.id);
            }
            
            close() {
                this.element.remove();
                this.taskbarItem.remove();
                windows = windows.filter(w => w.id !== this.id);
            }
        }
        
        // Application Functions
        function openApp(appName) {
            // Close start menu
            document.getElementById('start-menu').classList.add('hidden');
            
            // Check if window already exists
            const existingWindow = windows.find(w => w.id === appName);
            if (existingWindow) {
                if (existingWindow.isMinimized) {
                    existingWindow.restore();
                } else {
                    bringToFront(appName);
                }
                return;
            }
            
            let windowContent = '';
            let width = 400;
            let height = 300;
            let title = '';
            
            switch(appName) {
                case 'notepad':
                    title = 'Untitled - Notepad';
                    width = 500;
                    height = 400;
                    windowContent = `
                        <textarea id="notepad-text" class="w-full h-full win95-bevel-inset p-2 font-mono text-sm resize-none" 
                                  style="height: calc(100% - 40px);" 
                                  placeholder="Type here..."></textarea>
                        <div class="mt-2 text-xs">
                            <span id="notepad-status">Length: 0</span>
                        </div>
                    `;
                    break;
                    
                case 'minesweeper':
                    title = 'Minesweeper';
                    width = 320;
                    height = 400;
                    windowContent = `
                        <div class="text-center mb-2">
                            <div class="win95-bevel p-2 inline-block">
                                <span id="mines-count" class="font-mono text-xl">üí£ 10</span>
                            </div>
                            <div class="win95-bevel p-2 inline-block mx-4">
                                <span id="time" class="font-mono text-xl">‚è± 0</span>
                            </div>
                            <button onclick="restartMinesweeper()" class="win95-button">New Game</button>
                        </div>
                        <div id="minesweeper-grid" class="grid gap-1 justify-center">
                            <!-- Grid will be generated by JavaScript -->
                        </div>
                        <div class="mt-2 text-xs text-center">
                            <p>Tap to reveal, long press to flag</p>
                        </div>
                    `;
                    break;
                    
                case 'calculator':
                    title = 'Calculator';
                    width = 250;
                    height = 320;
                    windowContent = `
                        <div class="calculator">
                            <input type="text" id="calc-display" readonly 
                                   class="w-full win95-bevel-inset p-2 text-right text-xl font-mono mb-2" value="0">
                            <div class="grid grid-cols-4 gap-2">
                                <button class="win95-button h-10" onclick="calcClear()">C</button>
                                <button class="win95-button h-10" onclick="calcClearEntry()">CE</button>
                                <button class="win95-button h-10" onclick="calcBackspace()">‚Üê</button>
                                <button class="win95-button h-10" onclick="calcOperation('/')">/</button>
                                
                                <button class="win95-button h-10" onclick="calcInput('7')">7</button>
                                <button class="win95-button h-10" onclick="calcInput('8')">8</button>
                                <button class="win95-button h-10" onclick="calcInput('9')">9</button>
                                <button class="win95-button h-10" onclick="calcOperation('*')">*</button>
                                
                                <button class="win95-button h-10" onclick="calcInput('4')">4</button>
                                <button class="win95-button h-10" onclick="calcInput('5')">5</button>
                                <button class="win95-button h-10" onclick="calcInput('6')">6</button>
                                <button class="win95-button h-10" onclick="calcOperation('-')">-</button>
                                
                                <button class="win95-button h-10" onclick="calcInput('1')">1</button>
                                <button class="win95-button h-10" onclick="calcInput('2')">2</button>
                                <button class="win95-button h-10" onclick="calcInput('3')">3</button>
                                <button class="win95-button h-10" onclick="calcOperation('+')">+</button>
                                
                                <button class="win95-button h-10" onclick="calcNegate()">+/-</button>
                                <button class="win95-button h-10" onclick="calcInput('0')">0</button>
                                <button class="win95-button h-10" onclick="calcInput('.')">.</button>
                                <button class="win95-button h-10" onclick="calcEquals()">=</button>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'paint':
                    title = 'Paint';
                    width = 500;
                    height = 400;
                    windowContent = `
                        <div class="flex h-full">
                            <div class="w-16 win95-bevel-inset p-2 mr-2">
                                <div class="tool selected mb-2 p-1 text-center cursor-pointer" data-tool="pencil">
                                    ‚úèÔ∏è
                                </div>
                                <div class="tool mb-2 p-1 text-center cursor-pointer" data-tool="eraser">
                                    üßΩ
                                </div>
                                <div class="color mb-2 w-6 h-6 mx-auto cursor-pointer bg-black" data-color="#000000"></div>
                                <div class="color mb-2 w-6 h-6 mx-auto cursor-pointer bg-red-500" data-color="#ff0000"></div>
                                <div class="color mb-2 w-6 h-6 mx-auto cursor-pointer bg-blue-500" data-color="#0000ff"></div>
                                <div class="color mb-2 w-6 h-6 mx-auto cursor-pointer bg-green-500" data-color="#00ff00"></div>
                            </div>
                            <div class="flex-1">
                                <canvas id="paint-canvas" width="400" height="300" 
                                        class="w-full h-full win95-bevel-inset bg-white"></canvas>
                                <div class="mt-2">
                                    <button onclick="clearCanvas()" class="win95-button mr-2">Clear</button>
                                    <button onclick="saveCanvas()" class="win95-button">Save</button>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'mycomputer':
                    title = 'My Computer';
                    width = 400;
                    height = 300;
                    windowContent = `
                        <div class="grid grid-cols-3 gap-4">
                            <div class="text-center cursor-pointer" ondblclick="alert('C: Drive opened')">
                                <div class="win95-bevel p-4 mb-2">
                                    <img src="https://img.icons8.com/color/48/000000/hard-drive.png" class="w-12 h-12 mx-auto">
                                </div>
                                <span class="text-sm">Local Disk (C:)</span>
                            </div>
                            <div class="text-center cursor-pointer" ondblclick="alert('D: Drive opened')">
                                <div class="win95-bevel p-4 mb-2">
                                    <img src="https://img.icons8.com/color/48/000000/cd.png" class="w-12 h-12 mx-auto">
                                </div>
                                <span class="text-sm">CD-ROM (D:)</span>
                            </div>
                            <div class="text-center cursor-pointer" ondblclick="alert('Control Panel opened')">
                                <div class="win95-bevel p-4 mb-2">
                                    <img src="https://img.icons8.com/color/48/000000/control-panel.png" class="w-12 h-12 mx-auto">
                                </div>
                                <span class="text-sm">Control Panel</span>
                            </div>
                        </div>
                    `;
                    break;
                    
                case 'recyclebin':
                    title = 'Recycle Bin';
                    width = 400;
                    height = 300;
                    windowContent = `
                        <div class="p-4 text-center">
                            <img src="https://img.icons8.com/color/96/000000/trash.png" class="w-24 h-24 mx-auto mb-4">
                            <p class="mb-2">The Recycle Bin is empty</p>
                            <button class="win95-button" onclick="alert('Recycle Bin emptied!')">Empty Recycle Bin</button>
                        </div>
                    `;
                    break;
            }
            
            new Window(appName, title, windowContent, width, height);
            
            // Initialize app-specific functionality
            switch(appName) {
                case 'notepad':
                    initNotepad();
                    break;
                case 'minesweeper':
                    initMinesweeper();
                    break;
                case 'calculator':
                    initCalculator();
                    break;
                case 'paint':
                    initPaint();
                    break;
            }
        }
        
        function createWelcomeWindow() {
            const welcomeContent = `
                <div class="text-center p-8">
                    <h1 class="text-2xl font-bold mb-4">Welcome to Windows 95</h1>
                    <img src="https://img.icons8.com/color/96/000000/windows-logo.png" class="w-24 h-24 mx-auto mb-4">
                    <p class="mb-4">Mobile Touch-Optimized Emulation</p>
                    <div class="grid grid-cols-2 gap-4 mt-6">
                        <div class="text-center cursor-pointer" onclick="openApp('notepad')">
                            <div class="win95-bevel p-2 mb-2">
                                ‚úèÔ∏è
                            </div>
                            <span>Notepad</span>
                        </div>
                        <div class="text-center cursor-pointer" onclick="openApp('minesweeper')">
                            <div class="win95-bevel p-2 mb-2">
                                üí£
                            </div>
                            <span>Minesweeper</span>
                        </div>
                        <div class="text-center cursor-pointer" onclick="openApp('calculator')">
                            <div class="win95-bevel p-2 mb-2">
                                üßÆ
                            </div>
                            <span>Calculator</span>
                        </div>
                        <div class="text-center cursor-pointer" onclick="openApp('paint')">
                            <div class="win95-bevel p-2 mb-2">
                                üé®
                            </div>
                            <span>Paint</span>
                        </div>
                    </div>
                </div>
            `;
            
            new Window('welcome', 'Welcome to Windows 95', welcomeContent, 400, 350);
        }
        
        // Notepad Application
        function initNotepad() {
            const textarea = document.getElementById('notepad-text');
            if (textarea) {
                textarea.addEventListener('input', function() {
                    document.getElementById('notepad-status').textContent = 
                        `Length: ${this.value.length} characters`;
                });
                
                // Focus the textarea
                setTimeout(() => textarea.focus(), 100);
            }
        }
        
        // Minesweeper Application
        function initMinesweeper() {
            minesweeperGame = {
                grid: [],
                mineCount: 10,
                gridSize: 8,
                flags: 0,
                revealed: 0,
                gameOver: false,
                startTime: Date.now(),
                timerInterval: null
            };
            
            generateMinesweeperGrid();
            startMinesweeperTimer();
        }
        
        function generateMinesweeperGrid() {
            const grid = document.getElementById('minesweeper-grid');
            grid.innerHTML = '';
            grid.style.gridTemplateColumns = `repeat(${minesweeperGame.gridSize}, 30px)`;
            
            minesweeperGame.grid = [];
            
            // Initialize grid
            for (let y = 0; y < minesweeperGame.gridSize; y++) {
                minesweeperGame.grid[y] = [];
                for (let x = 0; x < minesweeperGame.gridSize; x++) {
                    minesweeperGame.grid[y][x] = {
                        isMine: false,
                        isRevealed: false,
                        isFlagged: false,
                        neighborMines: 0
                    };
                }
            }
            
            // Place mines
            let minesPlaced = 0;
            while (minesPlaced < minesweeperGame.mineCount) {
                const x = Math.floor(Math.random() * minesweeperGame.gridSize);
                const y = Math.floor(Math.random() * minesweeperGame.gridSize);
                
                if (!minesweeperGame.grid[y][x].isMine) {
                    minesweeperGame.grid[y][x].isMine = true;
                    minesPlaced++;
                    
                    // Update neighbor counts
                    for (let dy = -1; dy <= 1; dy++) {
                        for (let dx = -1; dx <= 1; dx++) {
                            const nx = x + dx;
                            const ny = y + dy;
                            if (nx >= 0 && nx < minesweeperGame.gridSize && 
                                ny >= 0 && ny < minesweeperGame.gridSize) {
                                minesweeperGame.grid[ny][nx].neighborMines++;
                            }
                        }
                    }
                }
            }
            
            // Create cells
            for (let y = 0; y < minesweeperGame.gridSize; y++) {
                for (let x = 0; x < minesweeperGame.gridSize; x++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell-hidden w-6 h-6 flex items-center justify-center text-sm';
                    cell.dataset.x = x;
                    cell.dataset.y = y;
                    
                    cell.addEventListener('click', () => revealCell(x, y));
                    cell.addEventListener('contextmenu', (e) => {
                        e.preventDefault();
                        toggleFlag(x, y);
                    });
                    
                    grid.appendChild(cell);
                }
            }
            
            updateMinesCount();
        }
        
        function revealCell(x, y) {
            if (minesweeperGame.gameOver) return;
            
            const cell = minesweeperGame.grid[y][x];
            if (cell.isRevealed || cell.isFlagged) return;
            
            cell.isRevealed = true;
            minesweeperGame.revealed++;
            
            const cellElement = document.querySelector(`#minesweeper-grid div[data-x="${x}"][data-y="${y}"]`);
            
            if (cell.isMine) {
                // Game Over
                cellElement.className = 'cell-revealed w-6 h-6 flex items-center justify-center text-sm bg-red-200';
                cellElement.textContent = 'üí£';
                gameOver(false);
                return;
            }
            
            cellElement.className = `cell-revealed w-6 h-6 flex items-center justify-center text-sm number-${cell.neighborMines}`;
            
            if (cell.neighborMines > 0) {
                cellElement.textContent = cell.neighborMines;
            } else {
                cellElement.textContent = '';
                // Reveal adjacent cells
                for (let dy = -1; dy <= 1; dy++) {
                    for (let dx = -1; dx <= 1; dx++) {
                        const nx = x + dx;
                        const ny = y + dy;
                        if (nx >= 0 && nx < minesweeperGame.gridSize && 
                            ny >= 0 && ny < minesweeperGame.gridSize) {
                            if (!minesweeperGame.grid[ny][nx].isRevealed) {
                                setTimeout(() => revealCell(nx, ny), 50);
                            }
                        }
                    }
                }
            }
            
            // Check win condition
            if (minesweeperGame.revealed === (minesweeperGame.gridSize * minesweeperGame.gridSize - minesweeperGame.mineCount)) {
                gameOver(true);
            }
        }
        
        function toggleFlag(x, y) {
            if (minesweeperGame.gameOver) return;
            
            const cell = minesweeperGame.grid[y][x];
            if (cell.isRevealed) return;
            
            cell.isFlagged = !cell.isFlagged;
            minesweeperGame.flags += cell.isFlagged ? 1 : -1;
            
            const cellElement = document.querySelector(`#minesweeper-grid div[data-x="${x}"][data-y="${y}"]`);
            
            if (cell.isFlagged) {
                cellElement.className = 'cell-flag w-6 h-6 flex items-center justify-center text-sm';
                cellElement.textContent = 'üö©';
            } else {
                cellElement.className = 'cell-hidden w-6 h-6 flex items-center justify-center text-sm';
                cellElement.textContent = '';
            }
            
            updateMinesCount();
        }
        
        function updateMinesCount() {
            const remaining = minesweeperGame.mineCount - minesweeperGame.flags;
            document.getElementById('mines-count').textContent = `üí£ ${remaining}`;
        }
        
        function startMinesweeperTimer() {
            clearInterval(minesweeperGame.timerInterval);
            minesweeperGame.startTime = Date.now();
            minesweeperGame.timerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - minesweeperGame.startTime) / 1000);
                document.getElementById('time').textContent = `‚è± ${elapsed}`;
            }, 1000);
        }
        
        function gameOver(isWin) {
            minesweeperGame.gameOver = true;
            clearInterval(minesweeperGame.timerInterval);
            
            if (isWin) {
                alert('Congratulations! You won!');
            } else {
                alert('Game Over! You hit a mine!');
            }
        }
        
        function restartMinesweeper() {
            clearInterval(minesweeperGame.timerInterval);
            initMinesweeper();
        }
        
        // Calculator Application
        let calculator = {
            display: '0',
            firstOperand: null,
            waitingForSecondOperand: false,
            operator: null
        };
        
        function initCalculator() {
            calculator = {
                display: '0',
                firstOperand: null,
                waitingForSecondOperand: false,
                operator: null
            };
            updateCalcDisplay();
        }
        
        function calcInput(digit) {
            const { display, waitingForSecondOperand } = calculator;
            
            if (waitingForSecondOperand) {
                calculator.display = digit;
                calculator.waitingForSecondOperand = false;
            } else {
                calculator.display = display === '0' ? digit : display + digit;
            }
            
            updateCalcDisplay();
        }
        
        function calcOperation(nextOperator) {
            const { firstOperand, display, operator } = calculator;
            const inputValue = parseFloat(display);
            
            if (operator && calculator.waitingForSecondOperand) {
                calculator.operator = nextOperator;
                return;
            }
            
            if (firstOperand === null) {
                calculator.firstOperand = inputValue;
            } else if (operator) {
                const currentValue = firstOperand || 0;
                const result = performCalculation[operator](currentValue, inputValue);
                
                calculator.display = String(result);
                calculator.firstOperand = result;
            }
            
            calculator.waitingForSecondOperand = true;
            calculator.operator = nextOperator;
            updateCalcDisplay();
        }
        
        const performCalculation = {
            '/': (firstOperand, secondOperand) => firstOperand / secondOperand,
            '*': (firstOperand, secondOperand) => firstOperand * secondOperand,
            '+': (firstOperand, secondOperand) => firstOperand + secondOperand,
            '-': (firstOperand, secondOperand) => firstOperand - secondOperand,
            '=': (firstOperand, secondOperand) => secondOperand
        };
        
        function calcEquals() {
            const { firstOperand, display, operator } = calculator;
            const inputValue = parseFloat(display);
            
            if (operator) {
                const result = performCalculation[operator](firstOperand, inputValue);
                calculator.display = String(result);
                calculator.firstOperand = null;
                calculator.waitingForSecondOperand = true;
                calculator.operator = null;
                updateCalcDisplay();
            }
        }
        
        function calcClear() {
            calculator.display = '0';
            calculator.firstOperand = null;
            calculator.waitingForSecondOperand = false;
            calculator.operator = null;
            updateCalcDisplay();
        }
        
        function calcClearEntry() {
            calculator.display = '0';
            updateCalcDisplay();
        }
        
        function calcBackspace() {
            calculator.display = calculator.display.length > 1 ? 
                calculator.display.slice(0, -1) : '0';
            updateCalcDisplay();
        }
        
        function calcNegate() {
            calculator.display = String(-parseFloat(calculator.display));
            updateCalcDisplay();
        }
        
        function updateCalcDisplay() {
            document.getElementById('calc-display').value = calculator.display;
        }
        
        // Paint Application
        let paint = {
            canvas: null,
            context: null,
            painting: false,
            tool: 'pencil',
            color: '#000000',
            lineWidth: 2
        };
        
        function initPaint() {
            const canvas = document.getElementById('paint-canvas');
            paint.canvas = canvas;
            paint.context = canvas.getContext('2d');
            
            // Set canvas size
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            // Clear canvas
            paint.context.fillStyle = '#ffffff';
            paint.context.fillRect(0, 0, canvas.width, canvas.height);
            
            // Setup tools
            document.querySelectorAll('.tool').forEach(tool => {
                tool.addEventListener('click', function() {
                    document.querySelectorAll('.tool').forEach(t => t.classList.remove('selected'));
                    this.classList.add('selected');
                    paint.tool = this.dataset.tool;
                });
            });
            
            // Setup colors
            document.querySelectorAll('.color').forEach(color => {
                color.addEventListener('click', function() {
                    paint.color = this.dataset.color;
                });
            });
            
            // Setup drawing
            canvas.addEventListener('mousedown', startPosition);
            canvas.addEventListener('mouseup', finishedPosition);
            canvas.addEventListener('mousemove', draw);
            
            // Touch events for mobile
            canvas.addEventListener('touchstart', function(e) {
                e.preventDefault();
                const touch = e.touches[0];
                const mouseEvent = new MouseEvent('mousedown', {
                    clientX: touch.clientX,
                    clientY: touch.clientY
                });
                canvas.dispatchEvent(mouseEvent);
            });
            
            canvas.addEventListener('touchmove', function(e) {
                e.preventDefault();
                const touch = e.touches[0];
                const mouseEvent = new MouseEvent('mousemove', {
                    clientX: touch.clientX,
                    clientY: touch.clientY
                });
                canvas.dispatchEvent(mouseEvent);
            });
            
            canvas.addEventListener('touchend', function(e) {
                e.preventDefault();
                const mouseEvent = new MouseEvent('mouseup', {});
                canvas.dispatchEvent(mouseEvent);
            });
        }
        
        function startPosition(e) {
            paint.painting = true;
            draw(e);
        }
        
        function finishedPosition() {
            paint.painting = false;
            paint.context.beginPath();
        }
        
        function draw(e) {
            if (!paint.painting) return;
            
            const rect = paint.canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            paint.context.lineWidth = paint.lineWidth;
            paint.context.lineCap = 'round';
            
            if (paint.tool === 'pencil') {
                paint.context.strokeStyle = paint.color;
                paint.context.lineTo(x, y);
                paint.context.stroke();
                paint.context.beginPath();
                paint.context.moveTo(x, y);
            } else if (paint.tool === 'eraser') {
                paint.context.strokeStyle = '#ffffff';
                paint.context.lineWidth = 10;
                paint.context.lineTo(x, y);
                paint.context.stroke();
                paint.context.beginPath();
                paint.context.moveTo(x, y);
            }
        }
        
        function clearCanvas() {
            paint.context.fillStyle = '#ffffff';
            paint.context.fillRect(0, 0, paint.canvas.width, paint.canvas.height);
        }
        
        function saveCanvas() {
            const link = document.createElement('a');
            link.download = 'windows95-paint.png';
            link.href = paint.canvas.toDataURL();
            link.click();
        }
        
        // Utility Functions
        function bringToFront(windowId) {
            const windows = document.querySelectorAll('.window');
            let maxZ = 40;
            
            windows.forEach(w => {
                const z = parseInt(w.style.zIndex) || 40;
                if (z > maxZ) maxZ = z;
            });
            
            const window = document.getElementById(windowId);
            if (window) {
                window.style.zIndex = maxZ + 1;
                activeWindow = windowId;
                
                // Update taskbar
                document.querySelectorAll('#taskbar-programs > div').forEach(item => {
                    item.classList.remove('win95-bevel-inset');
                });
                
                const windowObj = windows.find(w => w.id === windowId);
                if (windowObj && windowObj.taskbarItem) {
                    windowObj.taskbarItem.classList.add('win95-bevel-inset');
                }
            }
        }
        
        function closeWindow(windowId) {
            const window = windows.find(w => w.id === windowId);
            if (window) {
                window.close();
            }
        }
        
        function minimizeWindow(windowId) {
            const window = windows.find(w => w.id === windowId);
            if (window) {
                window.minimize();
            }
        }
        
        function maximizeWindow(windowId) {
            const window = windows.find(w => w.id === windowId);
            if (window) {
                window.maximize();
            }
        }
        
        function toggleStartMenu() {
            const menu = document.getElementById('start-menu');
            menu.classList.toggle('hidden');
            
            if (!menu.classList.contains('hidden')) {
                bringToFront('start-menu');
            }
        }
        
        function initClock() {
            function updateClock() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('en-US', {
                    hour: 'numeric',
                    minute: '2-digit',
                    hour12: true
                });
                document.getElementById('clock').textContent = timeString;
            }
            
            updateClock();
            setInterval(updateClock, 1000);
        }
        
        function setupTouchEvents() {
            // Prevent context menu on long press
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                return false;
            });
        }
        
        function shutdown() {
            if (confirm('Are you sure you want to shut down Windows 95?')) {
                document.body.innerHTML = `
                    <div class="w-full h-full bg-black flex items-center justify-center">
                        <div class="text-center text-white">
                            <p class="text-2xl mb-4">It's now safe to turn off your computer.</p>
                            <p class="text-gray-400">Windows 95 Mobile Emulation</p>
                        </div>
                    </div>
                `;
            }
        }
        
        // Handle window resize
        window.addEventListener('resize', function() {
            // Update cursor position if off screen
            if (cursorPos.x > window.innerWidth) cursorPos.x = window.innerWidth - 10;
            if (cursorPos.y > window.innerHeight) cursorPos.y = window.innerHeight - 10;
            
            const cursor = document.getElementById('custom-cursor');
            cursor.style.left = (cursorPos.x - 4) + 'px';
            cursor.style.top = (cursorPos.y - 4) + 'px';
        });
    </script>
</body>
</html>
